# Сервис по кластеризации и последующей классификации клиентов на основе активности для выявления чувствительных групп и снижения вероятности оттока клиентов.


Данный проект направлен на снижение вероятности оттока клиентов за счёт выявления ключевых групп в клиентской базе и последующего таргетированного маркетингового воздействия.

Как это работает:

1. Кластериация клиентов - алгоритм производит кластеризацию клиентов на ключевые группы для синтетической разметки датасета на основе их поведения и/или латентных признаков.

2. Приоритизация групп - выделяются сегменты с высоким риском оттока (одноразовые клиенты), потенциально лояльные и лояльные с максимальной ценностью для бизнеса.

3. Классификация клиентов - обучается алгоритм классификации новых клиентов для присвоения метки класса.




## Содержание

- [Данные](README.md#Данные)
- [Использование](README.md#Использование)
- [Примеры](README.md#Примеры)
- [Как работает](README.md#Как-работает)
- [Процесс разработки](README.md#Процесс-разработки)
- [Результат](README.md#Результат)
- [Дальнейшее развитие](README.md#Дальнейшее-развитие)
- [Заключение](README.md#Заключение)
- [Контрибьюторы](README.md#Контрибьюторы)

### Данные

При создании сервиса использовался комбинированный датасет состоящий из разрозненных выгрузок БД, было произведено слияние первичных таблиц исходя из логики сопоставления внешних ключей, произведена очистка от дублей и признаков с высоким уровнем пропусков (> 60%), и для удобства был сформирован унифицированный скрипт экстрактор, для обхода ограничений на размер загружаемых на GitHub данных (с потенциалом замены на модельную БД).

Первичный датасет состоит из нормализованных табличных данных описывающих транзакционную, поведеньческую, геолакационную и временную сущности клиентов онлайн-магазина.

<img src = https://github.com/alexkondrashov7/-hackathon_2025_mipt/blob/main/schema_data.png>

Для работы была произведена денормализация и feature-инжиниринг для создания комбинированного и/или латентного признакового пространства для парраллельной кластерицации методами RFM-анализа и KMeans-кластеризации.



:arrow_up:[К содержанию](README.md#Содержание)


### Использование



### Примеры



### Как работает



:arrow_up:[К содержанию](README.md#Содержание)

### Процесс разработки

1. Были проведены исследования по МЛ кластеризации объектов(https://github.com/alexkondrashov7/-hackathon_2025_mipt/blob/main/research/clusterisation.ipynb) и RFM-сегментации(https://github.com/alexkondrashov7/-hackathon_2025_mipt/blob/main/research/rfm.ipynb).

В обоих случаях ли выявлены определенные пересечения в кластеризации:

#### RFM-кластеризация
<img src = https://github.com/alexkondrashov7/-hackathon_2025_mipt/blob/main/research/labels/rfm_chart.png>

Выбор колличества кластеров обусловлен методологией

#### KMeans
<img src = https://github.com/alexkondrashov7/-hackathon_2025_mipt/blob/main/research/labels/kmeans_chart.png>

Выбор колличества кластеров был обусловлен паритетом между силуэтом и инерцией

<img src =https://github.com/alexkondrashov7/-hackathon_2025_mipt/blob/main/research/labels/kmeans_chart_силуэт.png>

2. На основе RFM и KMeans кластеризации было произведено сегментирование клиенсткой базы исходя из ключевых эвристик, с уклоном в базис RFM разметки, где были сформированые 3 ключевые группы:
 - Лояльные клиенты
 - Потенциально лояльные клиенты
 - Разовые клиенты

<img src = https://github.com/alexkondrashov7/-hackathon_2025_mipt/blob/main/research/labels/combo_chart.png>

В процессе тестого обучения классификатора, было выявлено отсутсвие связи признаков и комбинированной разметки, использование глубокой сетки, показало расходящийся лосс.

При этом обучение классификатора с метками из RFM-анализа (как более обоснованного методологически), на фитах которые использовались при kmeans- кластеризации (фитах которые не использовались при rfm, а значит утечки быть не может), показало достаточно обнадеживающие результаты.

3. Формируем портрет клиента на основе подхода который мы использовали для KMeans, но с учетом тех фитов которые мы можем поймать даже при первой покупке клиента, т.е. группа товаров, город, цена товара, оценка товара, что-то, что позволит нам идентифицировать клиента гораздо заранее с определенной долей вероятности. Затем приклеиваем метки из RFM и обучаем классификатор на основе NN.


4. В рамках предварительного этапа исследования был проведён первичный анализ пользовательского поведения на основе датасета (https://github.com/alexkondrashov7/-hackathon_2025_mipt/blob/main/research/rostelecom_ipynb.ipynb). 
Целью анализа являлось формирование и проверка продуктовых гипотез, способных выявить скрытые закономерности, влияющие на покупки, оценки и потенциальный отток пользователей. Предполагалось, что такие паттерны могут лечь в основу дальнейшего решения задачи и построения моделей предсказания пользовательской лояльности.
Каждая гипотеза формировалась на основе здравых предположений о пользовательской логике (например, скорость доставки, визуальное оформление товара, региональные особенности, день и время покупки) и затем проверялась статистически. 
Наиболее выраженное влияние на ключевые пользовательские метрики (частота заказов, повторные покупки, оценки) оказали время доставки, географические характеристики (как покупателей, так и продавцов), тип оплаты, а также временные факторы (день недели, время суток). Такие признаки, как количество фотографий, длина описания товара и активность в оставлении отзывов, не показали значимого влияния на поведение пользователей.
В результате анализа данных были выдвинуты следующие гипотезы:

    1. Пользователи, живущие в крупных городах, таких как Sao Paulo или Rio de Janeiro, не только делают больше покупок, но и имеют более высокую частоту покупок на одного пользователя по сравнению с теми, кто живет в менее крупных или удалённых регионах

    Результат: city_group
            Large City 1.213623
            Other City 1.193724

    Подтверждена: Нет, разница маленькая

    2. Количество фотографий влияет на количество заказов
    
    Результат: Корреляция между количеством фотографий и количеством заказов: 0.009723859445886449

    Подтверждена: Нет

    3. Пользователи, которые оставляют отзывы, более лояльны и чаще совершают покупки

    Результат: Среднее количество заказов у пользователей, оставивших отзывы: 1.1981792198168635. Среднее количество заказов у пользователей, не оставивших отзывы: 1.1666666666666667

    Подтверждена: Есть небольшая корреляция

    4. Покупатели, использующие определённые способы оплаты, более склонны делать крупные заказы (средняя сумма заказов)

    Результат: payment_type payment_value
                0 boleto 175.774904
                1 credit_card 178.609835
                2 debit_card 149.445684
                3 voucher 64.277077

    Подтверждена: Да

    5. Товары с более длинными описаниями имеют больше заказов

    Результат:

    Подтверждена: Нет

    6. Частота покупок в определённые сезоны (например, распродажи или праздники) возрастает

    Результат: Сложно судить, поскольку в 2016 данные за последние месяцы (пробные продажи), 2017 с активным ростом к концу года, данные за 2018 только на начало года

    Подтверждена:

    7. Удовлетворённость клиентов (из отзывов) зависит от того, насколько быстро товар был доставлен

    Результат: Самая сильная (отрицательная) корреляция:
                delivery_time (-0.303545) чем дольше доставка, тем ниже оценки;
                payment_value (-0.081312) возможно, более дорогие заказы вызывают завышенные ожидания и, если что-то не так, клиенты ставят низкие оценки


    Подтверждена:Да

    8. Покупатели, которые делают покупки в определённые дни недели, чаще делают покупки в будущем

    Результат: Нет корреляции

    Подтверждена: Нет

    9. Больше всего заказов в определенное время

    Результат: С 10-16 наибольшее количество заказов, можно отправлять пуши или напоминания в это время

    Подтверждена: Да

    10. Больше всего заказов в определенные дни недели

    Результат: Больше всего продаж по понедельникам и вторникам, меньше всего в субботу

    Подтверждена:Да

    11. Покупатели, получившие товары быстрее, могут быть более склонны делать повторные покупки

    Результат:is_repeat_customer
                False 12.114187
                True 11.612573


    Подтверждена: Да, покупатели, которые не делают повторные заказы False, то есть повторным клиентам доставляют немного быстрее, чем новым

    12. Пользователи, которые покупают более дешевые товары, делают больше повторных покупок по сравнению с теми, кто покупает товары более высокой стоимости

    Результат: price_category
                Cheap 0.325473
                Expensive 0.223915
                Name: is_repeat_customer, dtype: float64

    Подтверждена: Да

    13. Покупатели, которые делают больше покупок, с большей вероятностью оставляют отзывы о товарах

    Результат: Корреляция между количеством покупок и наличием отзыва: -0.01460151300588903

    Подтверждена: Нет

    14. Продавцы из разных регионов могут иметь разные оценки из-за особенностей логистики или культуры обслуживания

    Результат: Точно есть зависимость, это по убыванию количества заказов

    Подтверждена: Да

    15. Как рейтинг продавца соотносится с количеством товаров в заказах

    Результат: Корреляция между количеством товаров в заказе и средней оценкой: -0.09456166325015361

    Подтверждена: Нет

    16. Средние оценки варьируются в зависимости от месяца и сезона

    Результат: Наилучшие оценки в августе, летом

    Подтверждена: Да

    17. В мегаполисах покупают дороже - больше доход, дороже логистика, другие привычки

    Результат:

    Подтверждена: Да

    18. Чем дольше доставка, тем ниже оценка

    Результат: Среднее время доставки по оценкам:
                review_score
                1.0 19.14
                2.0 15.30
                3.0 13.57
                4.0 11.78
                5.0 10.20

    Подтверждена: Да

По результатам первичного анализа рекомендуется сосредоточить внимание на следующих направлениях:
Фокус на доставку и географию, так как они заметно влияют на оценки и повторные заказы; 


<img src = https://github.com/alexkondrashov7/-hackathon_2025_mipt/blob/main/research/product/1.png>

Использование данных о времени активности пользователей при построении маркетинговых коммуникаций и push-стратегий;

<img src = https://github.com/alexkondrashov7/-hackathon_2025_mipt/blob/main/research/product/2.png>

Скептически относиться к описаниям и фотографиям - они важны, но на конверсии почти не влияют; 

<img src = https://github.com/alexkondrashov7/-hackathon_2025_mipt/blob/main/research/product/3.png>



5. На основе исследований были созданы микросервисы для разметки первичных данных kmeans-лэйблы(https://github.com/alexkondrashov7/-hackathon_2025_mipt/blob/main/services/kmeans.py) и RFM-лэйблы(https://github.com/alexkondrashov7/-hackathon_2025_mipt/blob/main/services/rfm.py).

6. Следующим этапом планиурется обучение классификатора на размеченных данных и интеграция в сервис-инференса, так же планируется создание БД на модельных данных для упрощения работы сервиса.

7. Для бэкэнд составляющей было создано базовое приложение (https://github.com/OIJTUMUCT/inference_service/tree/main), в персперктиве приложение отвечает за инференс модели.


:arrow_up:[К содержанию](README.md#Содержание)


### Результат



:arrow_up:[К содержанию](README.md#Содержание)


### Дальнейшее развитие



### Заключение




### Контрибьюторы

:arrow_up:[К содержанию](README.md#Содержание)
